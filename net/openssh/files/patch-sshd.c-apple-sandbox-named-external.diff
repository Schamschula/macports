--- a/sshd.c	2014-03-17 00:22:44.000000000 -0700
+++ b/sshd.c	2014-03-17 00:32:54.000000000 -0700
@@ -711,11 +711,18 @@
 		set_log_handler(mm_log_handler, pmonitor);
 
 		/* Demote the child */
+#ifdef	__APPLE_SANDBOX_NAMED_EXTERNAL__
+		/* We need to do this before we chroot() so we can read sshd.sb */
+		if (box != NULL)
+			ssh_sandbox_child(box);
+#endif
 		if (getuid() == 0 || geteuid() == 0)
 			privsep_preauth_child();
 		setproctitle("%s", "[net]");
+#ifndef __APPLE_SANDBOX_NAMED_EXTERNAL__
 		if (box != NULL)
 			ssh_sandbox_child(box);
+#endif
 
 		return 0;
 	}
